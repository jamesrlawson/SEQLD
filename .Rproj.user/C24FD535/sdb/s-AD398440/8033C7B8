{
    "contents" : "## variance partioning analysis ##\n\nrequire(vegan)\nrequire(FD)\nrequire(MuMIn)\nrequire(nlme)\n\nalldata1$replicate <- sites$replicate\nalldata1.naomit <- na.omit(alldata1)\nCWM$regulation <- alldata1$regulation\nCWM.naomit <- na.omit(CWM[,1:6])\n\n#clim.dist <- gowdis(alldata1.naomit[,2:20])\n#soil.dist <- gowdis(alldata1.naomit[,21:32])\n#hydro.dist <- gowdis(alldata1.naomit[,33:66])\n#hydrochange.dist <- gowdis(alldata1.naomit[,85:116])\n\n#clim.pca <- prcomp(alldata1.naomit[,2:20], center=TRUE, scale=TRUE)\n#soil.pca <- prcomp(alldata1.naomit[,21:32], center=TRUE, scale=TRUE)\n#hydro.pca <- prcomp(alldata1.naomit[,33:66], center=TRUE, scale=TRUE)\n#hydrochange.pca <- prcomp(alldata1.naomit[,85:116], center=TRUE, scale=TRUE)\n\n#summary(clim.pca)\n#summary(soil.pca)\n#summary(hydro.pca)\n#summary(hydrochange.pca)\n\n# get PC's that represent > 0.1 of variance\n\n#clim.pc1 <- clim.pca$x[,1]\n#clim.pc2 <- clim.pca$x[,2]\n\n#soil.pc1 <- soil.pca$x[,1]\n#soil.pc2 <- soil.pca$x[,2]\n#soil.pc3 <- soil.pca$x[,3]\n\n#hydro.pc1 <- hydro.pca$x[,1]\n#hydro.pc2 <- hydro.pca$x[,2]\n#hydro.pc3 <- hydro.pca$x[,3]\n\n\n# what about hydrochange?\n\nallPC <- data.frame(cbind(alldata1.naomit[\"clim.pc1\"],\n                          alldata1.naomit[\"clim.pc2\"],\n                          alldata1.naomit[\"soil.pc1\"],\n                          alldata1.naomit[\"soil.pc2\"],\n                          alldata1.naomit[\"soil.pc3\"],\n                          alldata1.naomit[\"soil.pc4\"],                          \n                          alldata1.naomit[\"hydro.pc1\"],\n                          alldata1.naomit[\"hydro.pc2\"],\n                          alldata1.naomit[\"hydro.pc3\"],\n                          alldata1.naomit[\"hydro.pc4\"],\n                          alldata1.naomit[\"regulation\"],\n                          alldata1.naomit[\"FDis\"],\n                          alldata1.naomit[\"FRic\"],\n                          alldata1.naomit[\"FDiv\"],\n                          alldata1.naomit[\"FEve\"],\n                          alldata1.naomit[\"richness\"],\n                          alldata1.naomit[\"exotics\"]),\n                          alldata1.naomit[\"replicate\"])\n\nplot(allPC)\n\ngetAllStats(allPC, allPC$FDis, FD)\ngetAllStats(allPC, allPC$FRic, FD)\ngetAllStats(allPC, allPC$FEve, FD)\ngetAllStats(allPC, allPC$FDiv, FD)\n\ngetAllStats(allPC, allPC$exotics, FD)\ngetAllStats(allPC, allPC$richness, FD)\n\n\n\nFDis.lm <- lme(FDis ~ regulation + hydro.pc2 + soil.pc1, random = ~1|replicate, data = allPC)\nFDis.dredge <- dredge(FDis.lm)\nsubset(FDis.dredge, delta < 4)\nsummary(get.models(FDis.dredge, 2)[[1]])\n\nFDis.varpart <- varpart(allPC$FDis, ~ regulation, ~ hydro.pc2, ~ soil.pc1, data = allPC)\nFDis.varpart\nplot(FDis.varpart)\n\n\n\nexotics.lm <- lme(exotics ~ hydro.pc1 + I(hydro.pc1^2) + hydro.pc2 + I(hydro.pc2^2) + clim.pc1 + soil.pc2 + soil.pc3 + regulation, random = ~1|replicate, data = allPC)\nsummary(exotics.lm)\nexotics.dredge <- dredge(exotics.lm)\nsubset(exotics.dredge, delta < 4)\nsummary(get.models(exotics.dredge, 1)[[1]])\n\nexotics.varpart <- varpart(allPC$exotics, ~ hydro.pc1 + I(hydro.pc1^2) + hydro.pc2 + I(hydro.pc2^2), ~ clim.pc1 , ~ regulation + I(regulation^2),  ~ soil.pc2 + soil.pc3, data = allPC)\nexotics.varpart\nplot(exotics.varpart)\n\nhydro.pc1.quad <- hydro.pc1 + I(hydro.pc1^2)\nhydro.regulation.quad <- allPC$regulation + I(allPC$regulation^2)\n\nexotics.lm2 <- lm(exotics ~ hydro.pc1 + I(hydro.pc1^2) + regulation + I(regulation^2), data = allPC) # !!!\nexotics.lm2a <- lm(exotics ~ hydro.pc1.quad * hydro.regulation.quad, data = allPC)\nAICc(exotics.lm2,exotics.lm2a)\n\n\nrichness.lm <- lme(richness ~ clim.pc1 + soil.pc1 + soil.pc2, random = ~1|replicate, data = allPC)\nrichness.dredge <- dredge(richness.lm)\nsubset(richness.dredge, delta < 4)\nsummary(get.models(richness.dredge, 1)[[1]])\nsummary(lm(richness ~ soil.pc1 + soil.pc2, allPC))\nplot(richness ~ soil.pc1, allPC)\nplot(richness ~ soil.pc2, allPC)\n\nrichness.varpart <- varpart(allPC$richness, ~clim.pc1, ~ soil.pc1 + soil.pc2, data = allPC)\nrichness.varpart  \nplot(richness.varpart)\n\n\n  \n\n\n",
    "created" : 1432536256581.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "384940675",
    "id" : "8033C7B8",
    "lastKnownWriteTime" : 1432545594,
    "path" : "C:/Users/James/Desktop/stuff/data/analysis/R/SEQLD/scripts/model_building.R",
    "project_path" : "scripts/model_building.R",
    "properties" : {
        "tempName" : "Untitled5"
    },
    "source_on_save" : false,
    "type" : "r_source"
}