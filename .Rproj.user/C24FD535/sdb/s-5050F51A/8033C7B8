{
    "contents" : "## variance partioning analysis ##\n\nrequire(vegan)\nrequire(FD)\nrequire(MuMIn)\nrequire(nlme)\n\nalldata1$replicate <- sites$replicate\nalldata1.naomit <- na.omit(alldata1)\nCWM$regulation <- alldata1$regulation\nCWM.naomit <- na.omit(CWM[,1:6])\n\nalldata1.naomit$hydrochange.pc1 <- hydrochange.pca$x[,1]\nalldata1.naomit$hydrochange.pc2 <- hydrochange.pca$x[,2]\nalldata1.naomit$hydrochange.pc3 <- hydrochange.pca$x[,3]\n\nallPC <- data.frame(cbind(alldata1.naomit[\"clim.pc1\"],\n                          alldata1.naomit[\"clim.pc2\"],\n                          alldata1.naomit[\"soil.pc1\"],\n                          alldata1.naomit[\"soil.pc2\"],\n                          alldata1.naomit[\"soil.pc3\"],\n                          alldata1.naomit[\"hydro.pc1\"],\n                          alldata1.naomit[\"hydro.pc2\"],\n                          alldata1.naomit[\"hydro.pc3\"],\n                          alldata1.naomit[\"regulation\"],\n                          alldata1.naomit[\"production_natural_w\"],\n                          alldata1.naomit[\"production_dryland_w\"],\n                          alldata1.naomit[\"intensive_w\"],\n                          alldata1.naomit[\"conservation_w\"],\n                          alldata1.naomit[\"production_irrigated_w\"],\n                          alldata1.naomit[\"hydrochange.pc1\"],\n                          alldata1.naomit[\"hydrochange.pc2\"],\n                          alldata1.naomit[\"hydrochange.pc3\"],\n                          alldata1.naomit[\"FDis\"],\n                          alldata1.naomit[\"FRic\"],\n                          alldata1.naomit[\"FDiv\"],\n                          alldata1.naomit[\"FEve\"],\n                          alldata1.naomit[\"richness\"],\n                          alldata1.naomit[\"exotics\"],\n                          alldata1.naomit[\"replicate\"]))\n\nallPC$regulation <- allPC$regulation - mean(allPC$regulation) # center by mean to reduce vif in multiple regressions models\nallPC$production_natural_w <- allPC$production_natural_w - mean(allPC$production_natural_w)\nallPC$production_dryland_w <- allPC$production_dryland_w - mean(allPC$production_dryland_w)\nallPC$production_irrigated_w <- allPC$production_irrigated_w - mean(allPC$production_irrigated_w)\nallPC$conservation_w <- allPC$conservation_w - mean(allPC$conservation_w)\nallPC$intensive_w <- allPC$intensive_w - mean(allPC$intensive_w)\n\nplot(allPC)\n\n\ngetAllStats(allPC, allPC$FDis, FD)\ngetAllStats(allPC, allPC$FRic, FD)\ngetAllStats(allPC, allPC$FEve, FD)\ngetAllStats(allPC, allPC$FDiv, FD)\ngetAllStats(allPC, allPC$exotics, FD)\ngetAllStats(allPC, allPC$richness, FD)\ngetAllStats(allPC, allPC$hydrochange.pc1, FD)\ngetAllStats(allPC, allPC$hydrochange.pc2, FD)\ngetAllStats(allPC, allPC$hydrochange.pc3, FD)\ngetAllStats(allPC, allPC$regulation, FD)\n\ngetAllStats(alldata1.naomit, alldata1.naomit$FDis, FD)\ngetAllStats(alldata1.naomit, alldata1.naomit$FDiv, FD)\ngetAllStats(alldata1.naomit, alldata1.naomit$FRic, FD)\ngetAllStats(alldata1.naomit, alldata1.naomit$FEve, FD)\n\ngetAllStats(alldata1.naomit, alldata1.naomit$richness, FD)\ngetAllStats(alldata1.naomit, alldata1.naomit$exotics, FD)\n\ngetAllStats(alldata1.naomit, alldata1.naomit$hydro.pc1, FD)\ngetAllStats(alldata1.naomit, alldata1.naomit$hydro.pc2, FD)\ngetAllStats(alldata1.naomit, alldata1.naomit$regulation, FD)\n\n\nallPC$replicate <- as.factor(allPC$replicate)\n\n\nFDis.lm <- lme(FDis ~ regulation + I(regulation^2) + hydro.pc2 + hydro.pc3 + I(hydro.pc3^2) + soil.pc1, random = ~1|replicate, data = allPC)\nFDis.dredge <- dredge(FDis.lm, extra = c(\"R^2\",\"adjR^2\"))\nFDis.dredge\nsubset(FDis.dredge, delta < 4)\nsummary(get.models(FDis.dredge, 3)[[1]])\n\nFDis.varpart <- varpart(allPC$FDis, ~ regulation, ~ hydro.pc2, ~ soil.pc1, data = allPC)\nFDis.varpart\nplot(FDis.varpart)\n\n\n\n\n\n\n\nexotics.lm <- lm(exotics ~ hydro.pc1 + hydro.pc2 + clim.pc1 + clim.pc2 + soil.pc1 + soil.pc2 + regulation + I(regulation^2) + production_natural_w + production_dryland_w + intensive_w + conservation_w + production_irrigated_w, data = allPC)\n\n\nexotics.glm <- glm(exotics ~ hydro.pc1 + I(hydro.pc1^2) + hydro.pc2 + I(hydro.pc2^2) + clim.pc1 + soil.pc2 + soil.pc3 + regulation + I(regulation^2), data = allPC)\nexotics.lm <- lm(exotics ~ hydro.pc1 + I(hydro.pc1^2) + hydro.pc2 + I(hydro.pc2^2) + clim.pc1 + soil.pc2 + soil.pc3 + regulation + I(regulation^2),  data = allPC)\n\n\n\nsummary(exotics.lm)\nexotics.dredge <- dredge(exotics.lm)\nsubset(exotics.dredge, delta < 4)\nsummary(get.models(exotics.dredge, 1)[[1]])\nx <- model.avg(exotics.dredge)\nsummary(x)\n\n\nexotics.lm1 <- lm(formula = exotics ~ hydro.pc2 + production_irrigated_w + production_natural_w + \n     1, data = allPC)\n\nexotics.lm2 <- lm(formula = exotics ~ hydro.pc2 + production_irrigated_w + production_natural_w + regulation +\n                    1, data = allPC)\n\nexotics.dredge <- dredge(exotics.glm, rank = \"QAICc\", chat = deviance(exotics.glm) / df.residual(exotics.glm))\nsubset(exotics.dredge, delta < 4)\nsummary(model.avg(exotics.dredge))\n\n\n\n\nexotics.varpart1 <- varpart(allPC$exotics, ~ hydro.pc1 + I(hydro.pc1^2) + hydro.pc2 + I(hydro.pc2^2), ~ clim.pc1 , ~ regulation + I(regulation^2),  ~ soil.pc2 + soil.pc3, data = allPC)\nexotics.varpart2 <- varpart(allPC$exotics, ~ hydro.pc1 + I(hydro.pc1^2) + hydro.pc2 + I(hydro.pc2^2),  \n                                           ~ regulation + I(regulation^2), \n                                           ~ production_natural_w + production_dryland_w + intensive_w + conservation_w + production_irrigated_w, data = allPC)\n                                          \n\nexotics.varpart2\nplot(exotics.varpart)\n\nexotics.lm2x <- lm(exotics ~ hydro.pc1, allPC)\nexotics.lm2xq <- lm(exotics ~ hydro.pc1 + I(hydro.pc1^2), allPC)\nexotics.lm2y <- lm(exotics ~ regulation, allPC)\nexotics.lm2yq <- lm(exotics ~ regulation + I(regulation^2), allPC)\nexotics.lm2z <- lm(exotics ~ soil.pc2, allPC)\nexotics.lm2zq <- lm(exotics ~ soil.pc2 + I(soil.pc2^2), allPC)\n\nexotics.lm2 <- lm(exotics ~ hydro.pc1 + I(hydro.pc1^2) + regulation + I(regulation^2), data = allPC) # !!!\nexotics.lm2a <- lm(exotics ~ (hydro.pc1 +  I(hydro.pc1^2)) * (regulation + I(regulation^2)), data = allPC)\nexotics.lm2b <- lm(exotics ~ hydro.pc1 + I(hydro.pc1^2) + regulation + I(regulation^2) + hydro.pc1:regulation, data = allPC) # !!!\nexotics.lm2c <-  lm(exotics ~ hydro.pc1 + I(hydro.pc1^2) + regulation + hydro.pc1:regulation, data = allPC) # !!\nexotics.lm2d <-  lm(exotics ~ hydro.pc1 + I(hydro.pc1^2)+ hydro.pc2 + regulation + hydro.pc1:regulation, data = allPC) # !!\nexotics.lm2f <-  lm(exotics ~ hydro.pc1 + I(hydro.pc1^2)+  regulation + hydro.pc1:regulation + soil.pc2, data = allPC) # !!\nexotics.lm2g <-  lm(exotics ~ hydro.pc1 + I(hydro.pc1^2)+  regulation + hydro.pc1:regulation + soil.pc2 + soil.pc3, data = allPC) # !!\nexotics.lm2h <-  lm(exotics ~ hydro.pc1 + I(hydro.pc1^2)+  regulation + hydro.pc1:regulation  + soil.pc3, data = allPC)\nexotics.lm2i <-  lm(exotics ~ hydro.pc1 + I(hydro.pc1^2)+  regulation + hydro.pc1:regulation  + soil.pc2 + regulation:soil.pc2, data = allPC)\nexotics.lm2j <-  lm(exotics ~ hydro.pc1 + I(hydro.pc1^2)+  regulation + hydro.pc1:regulation  + soil.pc2 + regulation:soil.pc2 + hydro.pc1:soil.pc2, data = allPC)\nexotics.lm2k <-  lm(exotics ~ hydro.pc1 + I(hydro.pc1^2)+  regulation + I(regulation^2) + hydro.pc1:regulation  + soil.pc2 + regulation:soil.pc2 + hydro.pc1:soil.pc2, data = allPC)\nexotics.lm2l <-  lm(exotics ~ hydro.pc1 + I(hydro.pc1^2)+  regulation + hydro.pc1:regulation  + soil.pc2  +                      hydro.pc1:soil.pc2, data = allPC)\nexotics.lm2m <-  lm(exotics ~ hydro.pc1 + I(hydro.pc1^2) + regulation + hydro.pc1:regulation  + soil.pc2 + regulation:soil.pc2 + hydro.pc1:soil.pc2 + regulation:hydro.pc1:soil.pc2, data = allPC)\nexotics.lm2n <-  lm(exotics ~ hydro.pc1 + I(hydro.pc1^2) + hydro.pc2 + regulation + hydro.pc1:regulation  + soil.pc2 + regulation:soil.pc2 + hydro.pc1:soil.pc2 + regulation:hydro.pc1:soil.pc2, data = allPC)\nexotics.lm2j1 <- lme(exotics ~ hydro.pc1 + I(hydro.pc1^2)+  regulation + hydro.pc1:regulation  + soil.pc2 + regulation:soil.pc2 + hydro.pc1:soil.pc2, random = ~1|replicate, data = allPC)\n\nsummary(exotics.lm2)\nsummary(exotics.lm2a)\nsummary(exotics.lm2b) \nsummary(exotics.lm2c)\nsummary(exotics.lm2d)\nsummary(exotics.lm2e)\nsummary(exotics.lm2f)\nsummary(exotics.lm2g)\nsummary(exotics.lm2h)\nsummary(exotics.lm2i)\nsummary(exotics.lm2j)\nsummary(exotics.lm2j1)\nsummary(exotics.lm2k)\nsummary(exotics.lm2l)\nsummary(exotics.lm2m)\nsummary(exotics.lm2n)\n\n\nAICc(exotics.lm2x, exotics.lm2xq, exotics.lm2y, exotics.lm2yq, exotics.lm2z, exotics.lm2zq,exotics.lm2,exotics.lm2a, exotics.lm2b, exotics.lm2c, exotics.lm2d, exotics.lm2f, exotics.lm2g, exotics.lm2h, exotics.lm2i, exotics.lm2j, exotics.lm2j1,exotics.lm2k, exotics.lm2l)\nsummary(model.avg(exotics.lm2,exotics.lm2a, exotics.lm2b, exotics.lm2c, exotics.lm2d, exotics.lm2f, exotics.lm2g, exotics.lm2h, exotics.lm2i, exotics.lm2j, exotics.lm2k, exotics.lm2l))\n\ndredge(exotics.lm2j)\n\n\n\n\n\nrichness.lm <- lme(richness ~ clim.pc1 + soil.pc1 + soil.pc2, random = ~1|replicate, data = allPC)\nrichness.dredge <- dredge(richness.lm)\nsubset(richness.dredge, delta < 10)\nsummary(get.models(richness.dredge, 1)[[1]])\na<- lme(richness ~ soil.pc1 + soil.pc2, random = ~1|replicate, data = allPC)\nb<- lm(richness ~ soil.pc1 + soil.pc2, data = allPC)\nAICc(a,b)\n\nplot(richness ~ soil.pc1, allPC)\nplot(richness ~ soil.pc2, allPC)\n\nrichness.varpart <- varpart(allPC$richness, ~clim.pc1, ~ soil.pc1 + soil.pc2, data = allPC)\nrichness.varpart  \nplot(richness.varpart)\n\n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1432536256581.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3834639206",
    "id" : "8033C7B8",
    "lastKnownWriteTime" : 1433132260,
    "path" : "C:/Users/James/Desktop/stuff/data/analysis/R/SEQLD/scripts/model_building.R",
    "project_path" : "scripts/model_building.R",
    "properties" : {
        "tempName" : "Untitled5"
    },
    "relative_order" : 0,
    "source_on_save" : false,
    "type" : "r_source"
}