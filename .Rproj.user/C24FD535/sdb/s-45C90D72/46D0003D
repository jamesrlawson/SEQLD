{
    "contents" : "# CLIMATE #\nrequire(MASS)\nrequire(MuMIn)\nrequire(car)\n\nhydro <- read.csv(\"data/hydro_1975-2008.csv\", header=T)\nsites <- read.csv(\"data/sites.csv\", header=T)\nclimate <- read.csv(\"data/sites_clim_soil.csv\", header=T) \n\nclimate.site <- climate$site\nclimate <- data.frame(cbind(climate[,7:37], site = climate.site))\n\nhydro$MDF <- NULL\n\nhydrosites2 <- merge(hydro, sites, all.y=TRUE, by = c(\"gaugeID\"))\nhydrosites2 <- hydrosites2[order(hydrosites2$site),]\nhydrosites2 <- hydrosites2[,3:38]\n\nalldata <- merge(climate, hydrosites2, by=c(\"site\"))\n\nalldata <- alldata[,7:79]\nalldata$gaugeID.y <- NULL\nalldata$gaugeName.x <- NULL\n\nalldata1 <- alldata # for PCA\nalldata1$regulation <- NULL\nalldata1$PC1 <- NULL\nalldata1$PC2 <- NULL\nalldata1$PC3 <- NULL\nalldata1$PC4 <- NULL\nalldata1 <- data.frame(cbind(alldata1[,1:19], alldata1[,32:65]))\n\n\n\nalldata$site <- siteNums\nalldata$FDis <- FD$FDis\nalldata$FDiv <- FD$FDiv\nalldata$FRic <- FD$FRic\nalldata$FEve <- FD$FEve\nalldata$RaoQ <- FD$RaoQ\nalldata$FGR <- FD$FGR\nalldata$nbsp <- FD$nbsp\nalldata$simpson <- FD.redun$Simpson\nalldata$FunRao <- FD.redun$FunRao\nalldata$redun <- FD.redun$FunRedundancy\nalldata$nbsp <- FD$nbsp\nalldata$richness <- richness$richness\nalldata$exotics <- exotics.x$proportionExotic\n\nalldata$SLA<- CWM$SLA\nalldata$seed.mass <- CWM$seed.mass\nalldata$maximum.height <- CWM$maximum.height\nalldata$flowering.duration <- CWM$flowering.duration\nalldata$wood.density <- CWM$wood.density\nalldata$leaf.area <- CWM$leaf.area\n\n# getstats\n\nalldata$richness.stand <- richness$richness.stand\n\ngetStats(alldata, alldata$FDis, FD)\ngetAllStats(alldata, alldata$FDiv, FD)\ngetAllStats(alldata, alldata$FEve, FD)\ngetAllStats(alldata, alldata$FRic, FD)\ngetAllStats(alldata, alldata$RaoQ, FD)\ngetAllStats(alldata, alldata$simpson, FD)\ngetStats(alldata, alldata$richness, FD)\ngetStats(alldata, alldata$richness.stand, FD)\n\ngetAllStats(alldata, alldata$regulation, FD)\ngetStats(alldata, alldata$exotics, FD)\n\ngetAllStats(alldata, alldata$SLA, CWM)\ngetAllStats(alldata, alldata$seed.mass, CWM)\ngetAllStats(alldata, alldata$maximum.height, CWM)\ngetAllStats(alldata, alldata$flowering.duration, CWM)\ngetAllStats(alldata, alldata$wood.density, CWM)\ngetAllStats(alldata, alldata$leaf.area, CWM)\n\n\n# dimensionality reduction...\n\nwrite.csv(cor(alldata1), \"output/variables_cor.csv\")\nalldata.pca <- prcomp(alldata1, center=TRUE, scale=TRUE, retx =TRUE)\nsummary(alldata.pca)\nbiplot(alldata.pca)\n\n  # FDis\n\n# exotics included in FDis.sig depending on whether quad (sig) or linear (non-sig) p val is used\n\nFDis.sig <- data.frame(cbind(alldata[\"regulation\"], \n                                     alldata[\"C_MaxM\"], \n                                     alldata[\"PS10YrARI\"],\n                                     alldata[\"LSPeak\"],\n                                     alldata[\"soil_awc\"],\n                                     alldata[\"exotics\"]))\nFDis.sig.pca <- prcomp(na.omit(FDis.sig), center=TRUE, scale=TRUE, retx =TRUE)\nsummary(FDis.sig.pca)\nbiplot(FDis.sig.pca)\n\nFDis.lm <- lm(FDis ~ C_MaxM + PS10YrARI + LSPeak + soil_awc + regulation + exotics, data = na.omit(alldata))\nstepAIC(FDis.lm, direction=\"both\")\n\nFDis.lm.opt <- lm(FDis ~ C_MaxM + regulation , data = alldata)\nsummary(FDis.lm.opt)\n\nFDis.lm.opt2 <- lm(FDis ~ C_MaxM + I(C_MaxM^2) + regulation + I(regulation^2), data = alldata)\nsummary(FDis.lm.opt)\n\nFDis.lm.opt3a <- lm(formula = FDis ~ C_MaxM + PS10YrARI + regulation, \n                   data = na.omit(alldata))\n\nFDis.lm.opt3b <- lm(formula = FDis ~ C_MaxM + PS10YrARI + regulation + exotics, \n                    data = na.omit(alldata))\n\nAICc(FDis.lm, FDis.lm.opt, FDis.lm.opt2, FDis.lm.opt3a, FDis.lm.opt3b) \n\nvif(FDis.lm.opt3b)\n\n  # exotics\n\nexotics.sig <- data.frame(cbind(alldata[\"regulation\"],\n                                alldata[\"M_MaxM\"],\n                                alldata[\"M_MDFM\"],\n                                alldata[\"PS2YrARI\"],\n                                alldata[\"CVAnnBFI\"],\n                                alldata[\"MRateFall\"],\n                                alldata[\"MRateRise\"],\n                                alldata[\"CVAnnLSMeanDur\"],\n                                alldata[\"CVAnnLSNum\"],\n                                alldata[\"LSMeanDur\"],\n                                alldata[\"CVMDFDry\"],\n                                alldata[\"MDFAnnZer\"],\n                                alldata[\"soil_phc\"],\n                                alldata[\"soil_nto\"],\n                                alldata[\"soil_ece\"],\n                                alldata[\"soil_awc\"],\n                                alldata[\"clim_tsea\"],\n                                alldata[\"clim_trng\"],\n                                alldata[\"clim_tmin\"],\n                                alldata[\"clim_tmax\"],\n                                alldata[\"clim_pwrm\"],\n                                alldata[\"clim_pwmt\"],\n                                alldata[\"clim_pwet\"],\n                                alldata[\"clim_prec\"],\n                                alldata[\"clim_pdry\"],\n                                alldata[\"clim_pdmt\"],\n                                alldata[\"clim_pcld\"],\n                                alldata[\"clim_dnrg\"]))\n\nexotics.pca <- prcomp(na.omit(exotics.sig), center=TRUE, scale=TRUE, retx =TRUE)\nsummary(exotics.pca)    \nbiplot(exotics.pca)\nexotics.pca$rotation[,1:6]\n\nexotics.lm <- lm(FDis ~ regulation+\n                 M_MaxM+\n                 M_MDFM+\n                 PS2YrARI+\n                 CVAnnBFI+\n                 MRateFall+\n                 MRateRise+\n                 CVAnnLSMeanDur+\n                 CVAnnLSNum+\n                 LSMeanDur+\n                 CVMDFDry+\n                 MDFAnnZer+\n                 soil_phc+\n                 soil_nto+\n                 soil_ece+\n                 soil_awc+\n                 clim_tsea+\n                 clim_trng+\n                 clim_tmin+\n                 clim_tmax+\n                 clim_pwrm+\n                 clim_pwmt+\n                 clim_pwet+\n                 clim_prec+\n                 clim_pdry+\n                 clim_pdmt+\n                 clim_pcld+\n                 clim_dnrg, data = na.omit(alldata))\nstepAIC(exotics.lm, direction = \"both\")\n\nexotics1.lm <- lm(formula = FDis ~ M_MDFM + PS2YrARI + MRateRise + CVAnnLSMeanDur + \n                    MDFAnnZer + soil_phc + clim_tsea + clim_trng + clim_pwet + \n                    clim_prec + clim_pcld + clim_dnrg + soil_nto, data = na.omit(alldata))\n\nexotics2.lm <- lm(FDis ~ clim_pwrm + MRateRise + regulation + CVAnnLSMeanDur + soil_nto + MDFAnnZer, data = na.omit(alldata))\nsummary(exotics2.lm)\nstepAIC(exotics2.lm)\nexotics3.lm <- lm(FDis ~ regulation, data = alldata)\nexotics4.lm <- lm(FDis ~ regulation + I(regulation^2), data = alldata)\n\nAICc(exotics1.lm, exotics2.lm, exotics3.lm, exotics4.lm)\n\n\nvif(exotics2.lm)\n\n# richness\n\n\nrichness.sig <- cbind(alldata[\"M_MaxM\"],\n                      alldata[\"M_MinM\"],\n                      alldata[\"M_MDFM\"],\n                      alldata[\"CVAnnBFI\"],\n                      alldata[\"CVAnnLSMeanDur\"],\n                      alldata[\"CVAnnHSPeak\"],\n                      alldata[\"HSMeanDur\"],\n                      alldata[\"soil_soc\"],\n                      alldata[\"soil_slt\"],\n                      alldata[\"soil_phc\"],\n                      alldata[\"soil_ece\"],\n                      alldata[\"soil_bdw\"],\n                      alldata[\"soil_awc\"],\n                      alldata[\"clim_tsea\"],\n                      alldata[\"clim_trng\"],\n                      alldata[\"clim_tmin\"],\n                      alldata[\"clim_tmax\"],\n                      alldata[\"clim_tdry\"],\n                      alldata[\"clim_tcld\"],\n                      alldata[\"clim_tavg\"],\n                      alldata[\"clim_pwrm\"],\n                      alldata[\"clim_pwmt\"],\n                      alldata[\"clim_pwet\"],\n                      alldata[\"clim_prec\"],\n                      alldata[\"clim_pdry\"],\n                      alldata[\"clim_pdmt\"],\n                      alldata[\"clim_pcld\"],\n                      alldata[\"clim_dnrg\"],\n                      alldata[\"exotics\"])\n\nrichness.pca <- prcomp(na.omit(richness.sig), center=TRUE, scale=TRUE, retx =TRUE)\nbiplot(richness.pca)\nsummary(richness.pca)\nrichness.pca$rotation[,1:6]\n\nrichness.lm1 <- lm(richness ~ clim_pwmt + clim_trng + soil_phc + clim_tcld + clim_tavg + M_MaxM + HSMeanDur + exotics + CVAnnLSMeanDur, data = alldata)\nsummary(richness.lm1)\nstepAIC(richness.lm1, direction=\"both\")\nrichness.lm2 <- lm(formula = richness ~ clim_pwmt + clim_trng  + clim_tavg + exotics, \n                    data = alldata)\nsummary(richness.lm2)\nrichness.lm2a <- lm(formula = richness ~ clim_pwmt + clim_trng  + clim_tavg + I(clim_tavg^2) + exotics, \n                   data = alldata)\nsummary(richness.lm2a)\nrichness.lm3 <- lm(richness ~ exotics, data = alldata)\nrichness.lm3a <- lm(richness ~ exotics + I(exotics^2), data = alldata)\nsummary(richness.lm3a)\nrichness.lm.int1 <- lm(richness ~ clim_pwmt * clim_trng * clim_tavg * exotics, alldata)\nstepAIC(richness.lm.int1)\n\nrichness.lm.int2 <- lm(formula = richness ~ clim_pwmt + clim_trng + clim_tavg + exotics + \n     clim_pwmt:clim_trng + clim_pwmt:clim_tavg + clim_trng:clim_tavg + \n     clim_pwmt:clim_trng:clim_tavg, data = alldata)\n\nsummary(richness.lm.int2)\n\n\nAICc(richness.lm1,richness.lm2,richness.lm2a,richness.lm3,richness.lm3a,richness.lm.int1,richness.lm.int2)\n\n\nplot(richness ~ exotics, alldata)\nplot(richness ~ clim_pwmt, alldata)\nplot(richness ~ clim_trng, alldata)\nplot(richness ~ clim_tavg, alldata)\n",
    "created" : 1431922389672.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2218914809",
    "id" : "46D0003D",
    "lastKnownWriteTime" : 1432088526,
    "path" : "C:/Users/James/Desktop/stuff/data/analysis/R/SEQLD/scripts/climate_soil.R",
    "project_path" : "scripts/climate_soil.R",
    "properties" : {
        "tempName" : "Untitled4"
    },
    "source_on_save" : false,
    "type" : "r_source"
}