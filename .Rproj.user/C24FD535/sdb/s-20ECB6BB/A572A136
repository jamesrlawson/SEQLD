{
    "contents" : "source(\"scripts/functions.R\")\n#source(\"scripts/trait_cleaning.R\")\n\noptions(na.action = \"na.fail\")\n\nlibrary(plyr)\nlibrary(reshape2)\nlibrary(reshape)\nlibrary(FD)\nlibrary(ggplot2)\nlibrary(missForest)\nlibrary(SYNCSA)\nlibrary(fossil)\nrequire(vegan)\nrequire(MuMIn)\nrequire(nlme)\n\nalldata_reduced <- read.csv(\"data/alldata_naomit_reduced.csv\", header=T)\n\n# FDis #\n\ngetAllStats(alldata_reduced, alldata_reduced$FDis, FD)\n\nFDis <- lme(FDis ~ C_MaxM.x + I(C_MaxM.x^2) + LSPeak.x + I(LSPeak.x^2) + soil_soc, random = ~1|replicate, data = alldata_reduced)\nFDis.1 <- lm(FDis ~ C_MaxM.x + I(C_MaxM.x^2) + LSPeak.x + I(LSPeak.x^2) + soil_soc, data = alldata_reduced)\nFDis.2 <- lme(FDis ~ C_MaxM.x + I(C_MaxM.x^2) + LSPeak.x + I(LSPeak.x^2), random = ~1|replicate, data = alldata_reduced)\nFDis.3 <- lm(FDis ~ C_MaxM.x + I(C_MaxM.x^2) + LSPeak.x + I(LSPeak.x^2), data = alldata_reduced)\nFDis.4 <- lm(FDis ~ C_MaxM.x + I(C_MaxM.x^2), data = alldata_reduced)\nFDis.4a <- lm(log10(FDis) ~ C_MaxM.x + I(C_MaxM.x^2), data = alldata_reduced)\nFDis.5 <- lme(FDis ~ C_MaxM.x + I(C_MaxM.x^2), random = ~1|replicate, data = alldata_reduced)\nFDis.6 <- lm(FDis ~  C_MaxM.x + I(C_MaxM.x^2) + regulation + I(regulation^2), data = alldata_reduced)\n\nAICc(FDis,FDis.1,FDis.2,FDis.3,FDis.4, FDis.4a,FDis.5, FDis.6)\n\n# exotics #\n\ngetAllStats(alldata_reduced, alldata_reduced$exotics, FD)\n\nexotics.x.lme <- lme(exotics ~ CVAnnBFI.x + I(CVAnnBFI.x^2)\n                 + CVAnnLSMeanDur.x\n                 + C_MinM.x + I(C_MinM.x^2)\n                 + LSMeanDur.x + I(LSMeanDur.x^2)\n                 + C_MaxM.x\n                 + CVMDFDry.x + I(CVMDFDry.x^2)\n                 + CVAnnHSMeanDur.x\n                 + HSPeak.x + I(HSPeak.x^2), \n                 random = ~1|replicate,\n                 data = alldata_reduced)\n#exotics.x.lm.dredge <- dredge(exotics.x.lme)\n#summary(model.avg(exotics.x.lme.dredge))\n\nexotics.x.varpart <- varpart(alldata_reduced$exotics,  \n                            ~ CVAnnBFI.x + I(CVAnnBFI.x^2),\n#                          ~ C_MinM.x + I(C_MinM.x^2),\n                          ~ LSMeanDur.x + I(LSMeanDur.x^2),\n                         # ~ C_MaxM.x,\n                         # ~ CVMDFDry.x + I(CVMDFDry.x^2),\n                         # ~ CVAnnHSMeanDur.x,\n                          ~ HSPeak.x + I(HSPeak.x^2), \n                          data = alldata_reduced)\nexotics.x.varpart\nplot(exotics.x.varpart)\n\n\nexotics.landuse.varpart <- varpart(alldata_reduced$exotics,\n                                   ~production_irrigated_w + I(production_irrigated_w^2),\n                                   ~production_natural_w,\n                                   ~conservation_w + I(conservation_w^2),\n#                                   ~production_dryland_w, \n                                   data = alldata_reduced)\nexotics.landuse.varpart\nplot(exotics.landuse.varpart)\n\n\n#exotics.y.lm <- lm(exotics ~ C_MinM.y + I(C_MinM.y^2), data = alldata_reduced)\n\nexotics.soil.varpart <- varpart(alldata_reduced$exotics, \n                                ~soil_phc,\n                                ~soil_der,\n                                data = alldata_reduced)\nexotics.soil.varpart\nplot(exotics.soil.varpart)\n\n\nexotics.clim.varpart <- varpart(alldata_reduced$exotics, \n                               ~clim_tsea,\n                                ~clim_pdry + I(clim_pdry^2),\n                #                ~clim_pwet + I(clim_pwet^2),\n                                data = alldata_reduced)\nexotics.clim.varpart\nplot(exotics.clim.varpart)                                \n\n\n  # models\n\nexotics.x.lm <- lm(exotics ~ CVAnnBFI.x + I(CVAnnBFI.x^2)\n                            +LSMeanDur.x + I(LSMeanDur.x^2)\n                            +HSPeak.x + I(HSPeak.x^2), \n                   data = alldata_reduced)\nexotics.x.lme <- lme(exotics ~ CVAnnBFI.x + I(CVAnnBFI.x^2)\n                   +LSMeanDur.x + I(LSMeanDur.x^2)\n                   +HSPeak.x + I(HSPeak.x^2), \n                   random = ~1|replicate,\n                   data = alldata_reduced)\n\nexotics.landuse.lm <- lm(exotics ~production_irrigated_w + I(production_irrigated_w^2) \n                         + production_natural_w \n                         +conservation_w + I(conservation_w^2),\n                         data = alldata_reduced)\nexotics.landuse.lme <- lme(exotics ~ production_irrigated_w + I(production_irrigated_w^2) \n                           + production_natural_w \n                           +conservation_w + I(conservation_w^2),\n                           random = ~1|replicate,\n                           data = alldata_reduced)\n\nexotics.y.lm <- lm(exotics ~ C_MinM.y + I(C_MinM.y^2), data = alldata_reduced)\nexotics.y.lme<- lme(exotics ~ C_MinM.y + I(C_MinM.y^2), random = ~1|replicate, data = alldata_reduced)\n\nexotics.soil.lm <- lm(exotics ~ soil_phc + soil_der, data = alldata_reduced)\nexotics.soil.lme <- lme(exotics ~ soil_phc + soil_der, random = ~1|replicate, data = alldata_reduced)\n\nexotics.clim.lm <- lm(exotics ~ clim_tsea + clim_pdry + I(clim_pdry^2), data = alldata_reduced)\nexotics.clim.lme <- lme(exotics ~ clim_tsea + clim_pdry + I(clim_pdry^2), random = ~1|replicate, data = alldata_reduced)\n\nexotics.full.lm <- lm(exotics ~ CVAnnBFI.x + I(CVAnnBFI.x^2)\n                      +LSMeanDur.x + I(LSMeanDur.x^2) +HSPeak.x + I(HSPeak.x^2) \n                      + production_irrigated_w + I(production_irrigated_w^2)+ production_natural_w +conservation_w + I(conservation_w^2) \n                      + C_MinM.y + I(C_MinM.y^2) \n                      + clim_tsea + clim_pdry + I(clim_pdry^2), \n                      data = alldata_reduced)\n\nexotics.interaction.lm1a <- lm(exotics ~ CVAnnBFI.x + I(CVAnnBFI.x^2)+LSMeanDur.x + I(LSMeanDur.x^2)+HSPeak.x + I(HSPeak.x^2) + production_irrigated_w, data = alldata_reduced)\n\nexotics.interaction.lm1b <- lm(exotics ~ CVAnnBFI.x + I(CVAnnBFI.x^2)+LSMeanDur.x + I(LSMeanDur.x^2)+HSPeak.x + I(HSPeak.x^2) + production_irrigated_w + CVAnnBFI.x:production_irrigated_w, data = alldata_reduced)\n\nexotics.full.lm.dredge <- dredge(exotics.full.lm, m.max = 6, trace=TRUE)\nsubset(exotics.full.lm.dredge, delta < 4)\n\nexotics.best1a <- lm(exotics ~ +LSMeanDur.x + I(LSMeanDur.x^2)+HSPeak.x + I(HSPeak.x^2) + production_irrigated_w  + production_natural_w, data = alldata_reduced)\nexotics.best1b <- lm(exotics ~ +LSMeanDur.x + I(LSMeanDur.x^2)+HSPeak.x + I(HSPeak.x^2) + production_irrigated_w + I(production_irrigated_w^2) + production_natural_w + LSMeanDur.x:production_irrigated_w, data = alldata_reduced)\nexotics.best1c <- lm(exotics ~ +LSMeanDur.x + I(LSMeanDur.x^2)+HSPeak.x + I(HSPeak.x^2) + production_irrigated_w + production_natural_w, data = alldata_reduced)\nexotics.best1d <- lm(exotics ~ +LSMeanDur.x + I(LSMeanDur.x^2)+HSPeak.x + I(HSPeak.x^2), data = alldata_reduced)\n\nAICc(exotics.x.lm,\n     exotics.x.lme,\n     exotics.landuse.lm,\n     exotics.landuse.lme,\n     exotics.y.lm,\n     exotics.y.lme,\n     exotics.soil.lm,\n     exotics.soil.lme,\n     exotics.clim.lm,\n     exotics.clim.lme,\n     exotics.full.lm,\n     exotics.interaction.lm1a,\n     exotics.interaction.lm1b,\n     exotics.best1a,\n     exotics.best1b,\n     exotics.best1c,\n     exotics.best1d)\n     \n  \nexotics.full.varpart <- varpart(alldata_reduced$exotics, \n                                 ~ CVAnnBFI.x + I(CVAnnBFI.x^2)\n                                +LSMeanDur.x + I(LSMeanDur.x^2)\n                                +HSPeak.x + I(HSPeak.x^2),\n                                \n                                ~production_irrigated_w + I(production_irrigated_w^2) \n                                + production_natural_w \n                                +conservation_w + I(conservation_w^2),\n                                \n                                ~C_MinM.y + I(C_MinM.y^2),\n                                \n                             #   ~ soil_phc + soil_der,\n                                \n                                ~ clim_tsea + clim_pdry + I(clim_pdry^2),\n                                \n                                data = alldata_reduced)\n  \nexotics.full.varpart  \nplot(exotics.full.varpart)  \n\n\n\n# richness #\n\ngetAllStats(alldata_reduced, alldata_reduced$richness, FD)\n\nrichness.x.varpart <- varpart(alldata_reduced$richness, \n                              ~C_MinM.x + I(C_MinM.x^2),\n                            #  ~CVAnnHSMeanDur.x,\n                              ~M_MinM.x,\n                              ~HSMeanDur.x + I(HSMeanDur.x^2),\n                              data = alldata_reduced)\nrichness.x.varpart                              \nplot(richness.x.varpart)\n\n\nrichness.y.varpart <- varpart(alldata_reduced$richness,\n                              ~M_MinM.y + I(M_MinM.y^2),\n                              ~HSMeanDur.y + I(HSMeanDur.y^2), \n                              data = alldata_reduced)\nrichness.y.varpart                              \nplot(richness.y.varpart)\n\n\nrichness.clim.varpart <- varpart(alldata_reduced$richness,\n                                 ~ clim_pwet,\n                                # ~clim_tsea + I(clim_tsea^2),\n                                 ~clim_pdry,\n                                 ~clim_tcld + I(clim_tcld^2),\n                                 data = alldata_reduced)\nplot(richness.clim.varpart)\nrichness.clim.varpart\n\nrichness.soil.varpart <- varpart(alldata_reduced$richness, \n                                 ~ soil_pto,\n                                 ~ soil_phc, \n                                 ~ soil_soc,\n                                 data = alldata_reduced)\nrichness.soil.varpart\nplot(richness.soil.varpart)\n\n\nrichness.x.lm <- lm(richness \n                    ~C_MinM.x + I(C_MinM.x^2)\n                   + M_MinM.x\n                   + HSMeanDur.x + I(HSMeanDur.x^2),\n                    data = alldata_reduced)\n\nrichness.y.lm <- lm(richness ~ M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2), data = alldata_reduced)\n\nrichness.clim.lm <- lm(richness ~ clim_pwet + clim_pdry + clim_tcld + I(clim_tcld^2), data = alldata_reduced)\n\nrichness.soil.lm <- lm(richness ~ soil_pto + soil_phc + soil_soc, data = alldata_reduced)\n\nrichness.landuse.lm <- lm(richness ~ production_dryland_w + I(production_dryland_w^2), data = alldata_reduced)\n\nrichness.all.lm <- lm(richness ~ M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2) + clim_pwet + clim_pdry + clim_tcld + I(clim_tcld^2) + C_MinM.x + I(C_MinM.x^2)+ M_MinM.x + HSMeanDur.x + I(HSMeanDur.x^2), data = alldata_reduced)\n\nrichness.combined.lm1 <- lm(richness ~M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2) + clim_tsea, data = alldata_reduced)\n\nrichness.combined.lm2 <- lm(richness ~M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2) + clim_tsea + M_MinM.y:clim_tsea, data = alldata_reduced)\n\nrichness.combined.lm3 <- lm(richness ~ C_MinM.x + I(C_MinM.x^2) + M_MinM.x + HSMeanDur.x + I(HSMeanDur.x^2) + M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2) + clim_pwet + clim_pdry + clim_tcld + I(clim_tcld^2), data = alldata_reduced)\n\nrichness.combined.lm4 <- lm(richness ~M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2) + clim_pdry + HSMeanDur.y:clim_pdry, data = alldata_reduced)\n\nrichness.combined.lm5 <- lm(richness ~M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2) + clim_pdry + clim_tsea + HSMeanDur.y:clim_pdry +  M_MinM.y:clim_tsea, data = alldata_reduced)\n\nrichness.combined.lm6 <- lm(richness ~M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2) + clim_pdry + clim_tsea, data = alldata_reduced)\n\n\nAICc(richness.x.lm,\n     richness.y.lm,\n     richness.clim.lm,\n     richness.soil.lm,\n     richness.landuse.lm,\n     richness.all.lm,\n     richness.combined.lm1,\n     richness.combined.lm2,\n     richness.combined.lm3,\n     richness.combined.lm4,\n     richness.combined.lm5,\n     richness.combined.lm6)\n\nrichness.all.varpart <- varpart(alldata_reduced$richness,\n                               ~ C_MinM.x + I(C_MinM.x^2) + M_MinM.x + HSMeanDur.x + I(HSMeanDur.x^2),\n                                \n                                ~M_MinM.y + I(M_MinM.y^2) + HSMeanDur.y + I(HSMeanDur.y^2),\n                                \n                                ~clim_pwet + clim_pdry + clim_tcld + I(clim_tcld^2),\n                                \n                           #    ~soil_pto + soil_phc + soil_soc,\n                                \n                           #     ~production_dryland_w + I(production_dryland_w^2),\n                                \n                                data = alldata_reduced)\nrichness.all.varpart\nplot(richness.all.varpart)\n                                ",
    "created" : 1433304106793.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2025365514",
    "id" : "A572A136",
    "lastKnownWriteTime" : 1433404494,
    "path" : "C:/Users/James/Desktop/stuff/data/analysis/R/SEQLD/scripts/model_building3.R",
    "project_path" : "scripts/model_building3.R",
    "properties" : {
        "tempName" : "Untitled9"
    },
    "relative_order" : 11,
    "source_on_save" : false,
    "type" : "r_source"
}